@{
    // Check if the current page is the ScheduledTest page
    bool isScheduledTestPage = Context.Request.Path.Value?.Contains("/Test/ScheduledTest/") ?? false;

    // Check if we have a specific payment warning from the controller
    bool hasSpecificWarning = ViewBag.PaymentWarning != null;

    // Check if we have a booking status set by the controller
    bool hasBookingStatus = ViewBag.BookingStatus != null;

    // Check if the user just completed payment successfully
    bool justPaid = ViewBag.JustPaid == true || ViewBag.FromPayment == true;

    // Only show the payment warning if we have a booking status and it's "Pending"
    // AND the user hasn't just completed payment
    bool showWarning = hasBookingStatus && ViewBag.BookingStatus == "Pending" && !hasSpecificWarning && !justPaid;
}

@if (showWarning && User.Identity?.IsAuthenticated == true && User.IsInRole("Candidate"))
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-circle me-2"></i> Your booking payment is not confirmed. Please complete the payment process before starting the test.
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
